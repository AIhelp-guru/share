<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Google Sheets Web App Connector</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<h1>Google Sheets Web App Connector</h1>
    <input id="key" value="AKfycbxnrGpg-CCtIiBpIxQf821Mv9iPCKdnNdardLpu5y_nOTLktga_HkoULG3CI40eGp41Cg" />
<button id="readData">Read Data</button>
    <div id="output" style="border:1px solid black;padding:5px">Data will appear here...</div>


<br>
    <div style="position:fixed;bottom:0px">
    <input id="prompt" placeholder="ask anything else" />
<button id="askai">Ask AI</button><button id="writeData">Write Data</button>
    </div>
<script>
    var key = $("#key").val();
$(document).ready(function() {
    const webAppUrl = 'https://script.google.com/macros/s/'+key+'/exec'; // Replace with your Web App URL
 
    $('#readData').click(function() {
        $.ajax({
            url: webAppUrl,
            type: 'GET', // or 'POST' if your web app is set to handle POST for read
            data: { 'action': 'read' },
            success: function(response) {
                var output = "";
                for(i=0;i<response.length;i++){
                    r = response[i].toString();
                    qas = (r).split(",");
                     
                     output += ("<h3>"+ qas[0]+"</h3><div>"+qas[1]+"</div>");
                    //output += response[i] + "<br>";
                }
               $('#output').html(output);
            },
            error: function(xhr, status, error) {
                $('#output').html("Error: " + error);
            }
        });
    });
     $('#askai').click(function() {
        $.ajax({
            url: webAppUrl,
            type: 'GET', // or 'POST' if your web app is set to handle POST for read
            data: { 'action': 'askai', 'prompt': $("#prompt").val() },
            success: function(response) {
             
               $('#output').html(response);
                $('#readData').click(); 
            },
            error: function(xhr, status, error) {
                $('#output').html("Error: " + error);
            }
        });
    });

    $('#writeData').click(function() {
        $.ajax({
            url: webAppUrl,
            type: 'GET', // Change to 'POST' if using doPost in your Google Script
            data: { 'action': 'write' , 'prompt':$("#prompt").val()+','+$("#output").text()},
            success: function(response) {
                $('#output').html(response);
            },
            error: function(xhr, status, error) {
                $('#output').html("Error: " + error);
            }
        });
    });
});
</script>
</body>
</html>
