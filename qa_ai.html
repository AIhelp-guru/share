<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Google Sheets Web App Connector</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<h1>Google Sheets Web App Connector</h1>
<button id="readData">Read Data</button>
<button id="writeData">Write Data</button>
<br>
    <input id="prompt" placeholder="ask anything" />
<button id="askai">Ask AI</button>
<div id="output">Data will appear here...</div>

<script>
    var key = "AKfycbwirmm83h9w-KITg5mupHntLxTqjn0V2C9mGTG5Zfhle7q78NvC9e7O3nNkyWBlKVbqNA"
$(document).ready(function() {
    const webAppUrl = 'https://script.google.com/macros/s/'+key+'/exec'; // Replace with your Web App URL
 
    $('#readData').click(function() {
        $.ajax({
            url: webAppUrl,
            type: 'GET', // or 'POST' if your web app is set to handle POST for read
            data: { 'action': 'read' },
            success: function(response) {
                var output = "";
                for(i=0;i<response.length;i++){
                     output += (response[i]+"<br>");
                }
               $('#output').html(output);
            },
            error: function(xhr, status, error) {
                $('#output').html("Error: " + error);
            }
        });
    });
     $('#askai').click(function() {
        $.ajax({
            url: webAppUrl,
            type: 'GET', // or 'POST' if your web app is set to handle POST for read
            data: { 'action': 'askai', 'prompt': $("#prompt").val() },
            success: function(response) {
             
               $('#output').html(response);
            },
            error: function(xhr, status, error) {
                $('#output').html("Error: " + error);
            }
        });
    });

    $('#writeData').click(function() {
        $.ajax({
            url: webAppUrl,
            type: 'GET', // Change to 'POST' if using doPost in your Google Script
            data: { 'action': 'write' , 'qa':JSON.stringify({'q':'hello','a':'answer'}),
            success: function(response) {
                $('#output').html(response);
            },
            error: function(xhr, status, error) {
                $('#output').html("Error: " + error);
            }
        });
    });
});
</script>
</body>
</html>
